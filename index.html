<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UEH Food Map</title>

<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;800&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
<style>
  @font-face{
    font-family:'SVN-Dear Jane';
    src: local('SVN-Dear Jane Italic'), local('Dear Jane Italic');
    font-style: italic; font-weight: 600; font-display: swap;
  }
</style>

<style>
  :root{
    --bg:#FFD8E4; --panel:#111215; --text:#0f172a; --muted:#6b7280;
    --primary:#ffe082; --primary-strong:#ffd34a; --accent:#8ad7f7;
    --shadow:0 12px 30px rgba(17,18,21,.18);
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%}
  body{font-family:"Nunito",system-ui;background:var(--bg);color:var(--text)}

  /* NAV */
  .nav{position:sticky;top:0;z-index:80;background:rgba(255,255,255,.85);backdrop-filter:blur(10px);border-bottom:1px dashed rgba(0,0,0,.08)}
  .container{max-width:1360px;margin:0 auto;padding:0 24px}
  .nav-wrap{padding:16px 0;display:flex;justify-content:space-between;align-items:center}
  .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
  .brand span{
    font-family:"Times New Roman MT Condensed","Times New Roman","Times","Times New Roman PS",serif;
    font-style:italic; font-weight:700; letter-spacing:.3px; font-size:28px;
  }
  .brand-logo{width:56px;height:56px;aspect-ratio:1/1;object-fit:contain;border-radius:8px;background:#EAFEFF;filter:drop-shadow(0 2px 4px rgba(0,0,0,.18))}
  .tabs{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .tab{padding:12px 18px;border-radius:999px;background:#ffeef6;cursor:pointer;text-decoration:none;color:inherit;border:none;transition:.18s;font-size:18px;font-weight:800}
  .tab:hover{transform:translateY(-1px)} .tab.active{background:#ffe082;border:2px solid #ffd34a}
  .tab-dd{position:relative}
  .tab-dd .tab{display:flex;align-items:center;gap:8px}
  .chev{font-weight:900}
  .menu{position:absolute;top:calc(100% + 6px);left:0;background:#fff;border:2px solid #111;border-radius:14px;box-shadow:var(--shadow);padding:6px 8px;display:none;min-width:240px;z-index:90}
  .menu.open{display:block}
  .menu a{display:flex;align-items:center;gap:8px;padding:12px 14px;border-radius:10px;color:#0f172a;text-decoration:none;transition:transform .15s ease, background .15s ease, font-weight .15s ease;font-size:17px}
  .menu a:hover{background:#fff6bf;transform:translateX(4px) scale(1.02);font-weight:900}
  .login{border:2px solid #1aa3c7;background:#e6fbff;color:#0b6b86;border-radius:999px;padding:10px 16px;font-weight:900;cursor:pointer;font-size:16px}

  .titlebar h1{
    font-family:'SVN-Dear Jane',"Dear Jane","Dancing Script","Baloo 2",cursive;
    font-style:italic; font-weight:700; font-size:52px;
    margin:12px 0 8px;
  }

  .stage{
    background:var(--panel);
    border-radius:28px;
    padding:28px 24px 36px;
    box-shadow:0 20px 40px rgba(17,18,21,.25);
    position:relative; overflow:hidden;
  }

  /* HERO SLIDER */
  .hero{position:relative;border-radius:22px;overflow:hidden;box-shadow:var(--shadow);background:#000;margin-bottom:18px}
  .hero-viewport{width:100%;aspect-ratio:21/9;max-height:440px;overflow:hidden}
  .hero-track{display:flex;height:100%;transition:transform .55s cubic-bezier(.22,.61,.36,1);will-change:transform}
  .hero-slide{min-width:100%;height:100%;position:relative}
  .hero-slide img{width:100%;height:100%;object-fit:cover;display:block}
  /* Caption t√™n qu√°n tr√™n slide */
  .hero-cap{
    position:absolute;left:18px;bottom:18px;
    background:rgba(255,255,255,.92);
    border:3px solid #111;border-radius:16px;
    padding:8px 14px;box-shadow:0 10px 24px rgba(0,0,0,.35);
    font:800 22px "Baloo 2", system-ui;
  }
  .navbtn{position:absolute;top:50%;transform:translateY(-50%);width:46px;height:46px;border-radius:999px;border:1px solid rgba(0,0,0,.1);cursor:pointer;background:#fff;box-shadow:0 8px 18px rgba(0,0,0,.3)}
  .navbtn:hover{transform:translateY(-50%) scale(1.05)}
  .prev{left:16px}.next{right:16px}
  .pager{position:absolute;left:50%;bottom:12px;transform:translateX(-50%);display:flex;gap:8px;padding:6px 10px;background:rgba(0,0,0,.35);backdrop-filter:blur(4px);border-radius:999px}
  .dot{width:12px;height:12px;border-radius:50%;background:#d9d9d9;cursor:pointer;border:2px solid rgba(255,255,255,.9)}
  .dot.active{background:#2b6cff}

  /* Search ‚Äì tr·∫Øng s·∫°ch */
  .search{position:relative;margin:6px 0 18px}
  .search input{
    width:100%;height:56px;border-radius:999px;
    border:2px solid #ffd34a;padding:0 56px;font-size:18px;
    background:#fff;box-shadow:0 8px 18px rgba(0,0,0,.10);
  }
  .search .icon{position:absolute;left:18px;top:50%;transform:translateY(-50%);opacity:.7}

  /* Grid */
  .grid{display:grid;gap:22px;grid-template-columns:repeat(4, minmax(0,1fr))}
  @media (max-width:1200px){.grid{grid-template-columns:repeat(3,1fr)}}
  @media (max-width:880px){.grid{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:540px){.grid{grid-template-columns:1fr}}

  .card{background:#fff;border:2px solid #111;border-radius:26px;overflow:hidden;box-shadow:0 14px 28px rgba(0,0,0,.22);display:flex;flex-direction:column;cursor:pointer;transition:transform .18s}
  .card:hover{transform:translateY(-3px)}
  .thumb{position:relative}
  .thumb img{width:100%;height:160px;object-fit:cover}
  .rating{position:absolute;top:10px;right:10px;background:#111;color:#fff;padding:6px 10px;border-radius:999px;font-weight:900;border:2px solid #fff}
  .pillwrap{position:absolute;left:10px;bottom:10px;display:flex;gap:8px}
  .pill{background:#111;color:#fff;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:800;border:2px solid #fff}
  .body{padding:14px 16px}
  .name{font:800 20px "Baloo 2"; letter-spacing:.2px}
  .meta{color:var(--muted);font-size:14px}
  .show-more{display:block;margin:24px auto 0;background:var(--primary);border:3px solid #111;border-radius:999px;padding:12px 22px;font-weight:900;cursor:pointer}
  .card.hidden{display:none !important;}

  /* Ranking */
  .rank-list{display:flex;flex-direction:column;gap:12px}
  .rank-item{background:#fff;border:2px solid #111;border-radius:18px;padding:14px 16px;display:flex;align-items:center;gap:12px;box-shadow:var(--shadow);cursor:pointer;transition:transform .15s ease, box-shadow .15s ease}
  .rank-item:hover{transform:translateY(-2px) scale(1.01);box-shadow:0 16px 30px rgba(0,0,0,.18)}
  .rank-item:hover .rank-title{font-weight:900}
  .rank-no{width:46px;height:46px;border-radius:999px;display:grid;place-items:center;font-weight:900;border:2px solid #111;transition:transform .15s}
  .rank-item:hover .rank-no{transform:scale(1.05)}
  .no1{background:#ffe082}.no2{background:#e5e7eb}.no3{background:#fca5a5}.noN{background:#c7d2fe}
  .trend{margin-left:auto;font-weight:900}

  /* Modal & Auth gi·ªØ nguy√™n nh∆∞ c≈© */
  .modal,.auth{position:fixed;inset:0;display:none;align-items:center;justify-content:center;padding:20px;background:rgba(0,0,0,.55);z-index:120}
  .modal.show,.auth.show{display:flex;animation:fadeBg .25s ease forwards}
  @keyframes fadeBg{from{background:rgba(0,0,0,.0)}to{background:rgba(0,0,0,.55)}}
  .modal.closing,.auth.closing{animation:fadeBgOut .25s ease forwards}
  @keyframes fadeBgOut{from{background:rgba(0,0,0,.55)}to{background:rgba(0,0,0,0)}}
  .dialog,.auth-card{background:#fff;border:3px solid #111;border-radius:22px;max-width:560px;width:100%;box-shadow:var(--shadow);opacity:0;transform:translateY(-18px);animation:pop .28s ease forwards}
  @keyframes pop{to{opacity:1;transform:none}}
  .dialog.closing,.auth-card.closing{animation:fadeUpOut .28s ease forwards}
  @keyframes fadeUpOut{from{opacity:1;transform:none}to{opacity:0;transform:translateY(-18px)}}
  .dialog header,.auth-header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:2px dashed #ffd34a}
  .dialog .content{padding:16px}
  .auth-tabs{display:flex}
  .auth-tabs button{flex:1;padding:12px;border:2px dashed #ffd34a;background:#fff6bf;cursor:pointer;font-weight:900;transition:.15s}
  .auth-tabs button.active{background:#ffe082}
  .auth-body{padding:16px}
  .field{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
  .field input{height:44px;border:2px dashed #111;border-radius:12px;padding:0 12px}
  .auth-actions{display:flex;justify-content:flex-end;gap:10px}
  .btn{border:3px solid #111;border-radius:12px;padding:8px 14px;cursor:pointer;font-weight:900}
  .btn.primary{background:linear-gradient(#ffe082,#ffd34a)} .btn.light{background:#eef7fb}
  footer{text-align:center;padding:36px 0;color:#475569;font-family:"Baloo 2";font-weight:800}
</style>
</head>
<body>

<nav class="nav">
  <div class="container nav-wrap">
    <a class="brand" href="#home" aria-label="UEH Food Map">
      <img src="logo-pho.png" alt="" class="brand-logo"/>
      <span>UEH Food Map</span>
    </a>

    <div class="tabs" role="tablist">
      <div class="tab-dd">
        <button class="tab active" id="tabHomeBtn">Trang ch·ªß <span class="chev">‚ñæ</span></button>
        <div class="menu" id="homeMenu" role="menu">
          <a href="#" data-cat="all">T·∫•t c·∫£</a>
          <a href="#" data-cat="com">C∆°m</a>
          <a href="#" data-cat="bun">B√∫n/M√¨/Ph·ªü</a>
          <a href="#" data-cat="fast">ƒê·ªì ƒÉn nhanh</a>
          <a href="#" data-cat="other">Kh√°c</a>
          <a href="#" data-cat="drink">ƒê·ªì u·ªëng</a>
        </div>
      </div>
      <a class="tab" href="#rank" id="tabRank">Ranking: Top 5 tu·∫ßn</a>
      <a class="tab" href="#map">B·∫£n ƒë·ªì t∆∞∆°ng t√°c</a>
      <a class="tab" href="#chat">AI Botchat</a>
    </div>

    <button class="login" id="btnOpenAuth">ƒêƒÉng nh·∫≠p</button>
  </div>
</nav>

<section class="container" id="home">
  <div class="titlebar"><h1>Top qu√°n ƒÉn must try ü´∂üèª‚ù§Ô∏è‚Äçüî•</h1></div>

  <div class="stage">
    <div class="hero" aria-label="Top 5 qu√°n tu·∫ßn">
      <div class="hero-viewport">
        <div class="hero-track" id="heroTrack"></div>
      </div>
      <button class="navbtn prev" id="heroPrev" aria-label="Tr∆∞·ªõc">‚óÄ</button>
      <button class="navbtn next" id="heroNext" aria-label="Sau">‚ñ∂</button>
      <div class="pager" id="heroPager"></div>
    </div>

    <div class="search">
      <svg class="icon" width="22" height="22" viewBox="0 0 24 24" fill="none">
        <circle cx="11" cy="11" r="7" stroke="#0f172a" stroke-opacity=".8" stroke-width="2"/>
        <path d="M20 20l-3.5-3.5" stroke="#0f172a" stroke-opacity=".8" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <input id="search" type="text" placeholder="T√¨m ki·∫øm qu√°n ƒÉn, ƒë·ªãa ch·ªâ‚Ä¶"/>
    </div>

    <div class="grid" id="cards"></div>
    <button class="show-more" id="btnMore" hidden>Xem th√™m</button>
  </div>
</section>

<section class="container" id="rank" hidden>
  <div class="titlebar"><h1>B·∫£ng X·∫øp H·∫°ng Tu·∫ßn</h1></div>
  <div class="rank-list" id="rankList"></div>
</section>

<section class="container" id="map" hidden>
  <div class="titlebar"><h1>B·∫£n ƒë·ªì t∆∞∆°ng t√°c</h1></div>
  <div style="border-radius:22px;overflow:hidden;box-shadow:var(--shadow);border:2px solid #111">
    <img alt="Map placeholder" src="map.jpg" style="width:100%;height:440px;object-fit:cover"/>
  </div>
</section>

<section class="container" id="chat" hidden>
  <div class="titlebar"><h1>AI Botchat</h1></div>
  <div style="background:#fff;border:2px solid #111;border-radius:18px;box-shadow:var(--shadow);padding:16px">
    <div id="chatLog" style="height:280px;overflow:auto;padding:8px;border:1px dashed #ffd34a;border-radius:12px;background:#fffdf3"></div>
    <div style="display:flex;gap:8px;margin-top:10px">
      <input id="chatInput" placeholder="B·∫°n mu·ªën ƒÉn g√¨? (vd: ph·ªü, c∆°m, ƒë·ªì u·ªëng‚Ä¶)" style="flex:1;height:44px;border:2px dashed #111;border-radius:12px;padding:0 12px"/>
      <button id="chatSend" class="btn primary">G·ª≠i</button>
    </div>
  </div>
</section>

<div class="modal" id="modal">
  <div class="dialog" id="dlgBox">
    <header>
      <strong id="dlgTitle">Chi ti·∫øt qu√°n</strong>
      <button id="dlgClose" class="btn light">‚úï</button>
    </header>
    <div class="content" id="dlgContent"></div>
  </div>
</div>

<div class="auth" id="auth">
  <div class="auth-card" id="authCard" role="dialog" aria-modal="true">
    <div class="auth-header">
      <strong>T√†i kho·∫£n</strong>
      <button id="authClose" class="btn light">‚úï</button>
    </div>
    <div class="auth-tabs">
      <button id="tabLogin" class="active">ƒêƒÉng nh·∫≠p</button>
      <button id="tabRegister">ƒêƒÉng k√Ω</button>
    </div>
    <div class="auth-body">
      <div id="paneLogin">
        <div class="field"><label>Email</label><input type="email" id="loginEmail" placeholder="you@example.com"></div>
        <div class="field"><label>M·∫≠t kh·∫©u</label><input type="password" id="loginPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"></div>
        <div class="auth-actions"><button class="btn light" id="loginCancel">Hu·ª∑</button><button class="btn primary" id="loginSubmit">ƒêƒÉng nh·∫≠p</button></div>
      </div>
      <div id="paneRegister" style="display:none">
        <div class="field"><label>H·ªç v√† t√™n</label><input type="text" id="regName" placeholder="Nguy·ªÖn VƒÉn A"></div>
        <div class="field"><label>Email</label><input type="email" id="regEmail" placeholder="you@example.com"></div>
        <div class="field"><label>SƒêT</label><input type="tel" id="regPhone" placeholder="09xx xxx xxx"></div>
        <div class="field"><label>M·∫≠t kh·∫©u</label><input type="password" id="regPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"></div>
        <div class="auth-actions"><button class="btn light" id="regCancel">Hu·ª∑</button><button class="btn primary" id="regSubmit">ƒêƒÉng k√Ω</button></div>
      </div>
    </div>
  </div>
</div>

<footer class="container">¬© 2025 UEH Food Map ‚Äì cute mode üßÉ</footer>

<script>
/* ===== ROUTING ===== */
const sections=['home','rank','map','chat'];
function navigate(){
  const hash=(location.hash||'#home').replace('#','');
  sections.forEach(id=>document.getElementById(id).hidden=(id!==hash));
  document.querySelectorAll('.tabs .tab, .tabs .tab-dd .tab').forEach(t=>t.classList.remove('active'));
  if(hash==='home') document.getElementById('tabHomeBtn').classList.add('active');
  else document.querySelector(`.tabs a[href="#${hash}"]`)?.classList.add('active');
}
window.addEventListener('hashchange',navigate); navigate();

/* ===== DATA (·∫¢NH C·ª§C B·ªò: t√™n-file.jpg theo qu√°n) ===== */
const DATA=[
  {id:1, slug:'bun-quay-tam-quan', name:'B√∫n Qu·∫≠y T√ÇM QU√ÅN',addr:'210 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'50m',price:'40-60k',rate:4.4,cat:'bun'},
  {id:2, slug:'rau-ma-mix', name:'Rau m√° mix',addr:'269 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'60m',price:'12-34k',rate:4.2,cat:'drink'},
  {id:3, slug:'chicken-plus', name:'Chicken Plus',addr:'226 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'120m',price:'100k/ng∆∞·ªùi',rate:4.2,cat:'fast'},
  {id:4, slug:'bun-thai', name:'B√∫n Th√°i',addr:'325 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'350m',price:'29-59k',rate:4.9,cat:'bun'},
  {id:5, slug:'bun-bo-phuong-ngoc', name:'B√∫n b√≤ Ph∆∞∆°ng Ng·ªçc',addr:'384 H√≤a H·∫£o',dist:'160m',price:'38-48k',rate:4.5,cat:'bun'},
  {id:6, slug:'quan-chay-an-cat-tuong', name:'Qu√°n chay An C√°t T∆∞·ªùng',addr:'218 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'100m',price:'49-86k',rate:4.3,cat:'other'},
  {id:7, slug:'com-tom-phu-trung', name:'C∆°m t√¥m ph·ªß tr·ª©ng',addr:'ƒê√†o Duy T·ª´',dist:'50m',price:'35-40k',rate:4.8,cat:'com'},
  {id:8, slug:'tra-sua-gia-nghi', name:'Tr√† S·ªØa Gia Nghi',addr:'415A H√≤a H·∫£o',dist:'170m',price:'‚Äî',rate:5.0,cat:'drink'},
  {id:9, slug:'yi-jia-desert', name:'Yi Jia Desert',addr:'363 Vƒ©nh Vi·ªÖn',dist:'450m',price:'25-48k',rate:4.3,cat:'other'},
  {id:10, slug:'tra-sua-tuyet-ngan', name:'Tr√† s·ªØa Tuy·∫øt Ng√¢n',addr:'208/20/8 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'280m',price:'28-78k',rate:4.1,cat:'drink'},
  {id:11, slug:'bun-dau-mam-tom-tien-hai', name:'B√∫n ƒë·∫≠u m·∫Øm t√¥m Ti·∫øn H·∫£i',addr:'409 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'450m',price:'22-100k',rate:4.1,cat:'bun'},
  {id:12, slug:'tra-sua-phuong-hoang', name:'Tr√† s·ªØa Ph∆∞·ª£ng Ho√†ng',addr:'317B Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'80m',price:'25-35k',rate:4.3,cat:'drink'},
  {id:13, slug:'ha-cao-phanh', name:'H√° c·∫£o Ph√°nh',addr:'012 L√¥ B Chung c∆∞ Nguy·ªÖn Tr√£i',dist:'900m',price:'12-100k',rate:4.5,cat:'fast'},
  {id:14, slug:'com-ga-tam-ky', name:'C∆°m g√† Tam K·ª≥',addr:'65 ƒê√†o Duy T·ª´',dist:'30m',price:'35-50k',rate:4.6,cat:'com'},
  {id:15, slug:'bun-thai-com-viet', name:'B√∫n th√°i - C∆°m Vi·ªát',addr:'325 Nguy·ªÖn Tri Ph∆∞∆°ng',dist:'70m',price:'30-35k',rate:4.4,cat:'bun'}
];
const imgOf = (slug) => `${slug}.jpg`;

/* ===== HERO SLIDER (k√®m caption t√™n qu√°n) ===== */
const TOP5=[...DATA].sort((a,b)=>b.rate-a.rate).slice(0,5);
const heroTrack=document.getElementById('heroTrack');
const heroPager=document.getElementById('heroPager');
TOP5.forEach((x,i)=>{
  heroTrack.insertAdjacentHTML('beforeend',
    `<div class="hero-slide">
        <img src="${imgOf(x.slug)}" alt="Top ${i+1}: ${x.name}">
        <div class="hero-cap">${x.name}</div>
     </div>`);
  heroPager.insertAdjacentHTML('beforeend', `<button class="dot${i===0?' active':''}" data-idx="${i}" aria-label="Slide ${i+1}"></button>`);
});
let heroIdx=0;
function updateHero(){ heroTrack.style.transform=`translateX(-${heroIdx*100}%)`; document.querySelectorAll('.dot').forEach((d,i)=>d.classList.toggle('active', i===heroIdx));}
document.getElementById('heroPrev').onclick=()=>{heroIdx=(heroIdx+TOP5.length-1)%TOP5.length;updateHero();}
document.getElementById('heroNext').onclick=()=>{heroIdx=(heroIdx+1)%TOP5.length;updateHero();}
heroPager.addEventListener('click',e=>{const b=e.target.closest('.dot'); if(!b) return; heroIdx=+b.dataset.idx; updateHero();});
let heroAuto=setInterval(()=>{heroIdx=(heroIdx+1)%TOP5.length;updateHero();}, 5000);

/* ===== GRID ===== */
const grid=document.getElementById('cards'); const btnMore=document.getElementById('btnMore');
let currentCat='all', searchQuery='', expanded=false;

function formatCard(it){const price=it.price&&it.price.trim()?it.price:'‚Äî';
  return `<article class="card" data-id="${it.id}">
    <div class="thumb">
      <img src="${imgOf(it.slug)}" alt="${it.name}" loading="lazy"/>
      <span class="rating">‚òÖ ${it.rate}</span>
      <div class="pillwrap"><span class="pill">${it.dist}</span><span class="pill">${price}</span></div>
    </div>
    <div class="body"><div class="name">${it.name}</div><div class="meta">${it.addr}</div></div>
  </article>`;
}
function renderGrid(){
  const list=DATA.filter(x=>(currentCat==='all'||x.cat===currentCat) && ((x.name+' '+x.addr).toLowerCase().includes(searchQuery)));
  grid.innerHTML='';
  list.forEach((it,idx)=>{
    grid.insertAdjacentHTML('beforeend',formatCard(it));
    if(!expanded && idx>=8) grid.lastElementChild.classList.add('hidden');
  });
  btnMore.hidden=list.length<=8;
  btnMore.textContent=expanded?'Thu g·ªçn':'Xem th√™m';
}
btnMore.addEventListener('click',()=>{
  expanded=!expanded;
  grid.querySelectorAll('.card').forEach((c,i)=>c.classList.toggle('hidden',!expanded && i>=8));
  btnMore.textContent=expanded?'Thu g·ªçn':'Xem th√™m';
  if(!expanded) window.scrollTo({top:document.getElementById('home').offsetTop-60, behavior:'smooth'});
});

/* Dropdown Trang ch·ªß */
const tabHomeBtn=document.getElementById('tabHomeBtn');
const homeMenu=document.getElementById('homeMenu');
tabHomeBtn.addEventListener('click',(e)=>{
  e.stopPropagation();
  if(location.hash!=='#home') location.hash='#home';
  homeMenu.classList.toggle('open');
});
homeMenu.querySelectorAll('a').forEach(a=>{
  a.addEventListener('click',(e)=>{
    e.preventDefault();
    currentCat=a.dataset.cat||'all';
    expanded=false;
    homeMenu.classList.remove('open');
    renderGrid();
  });
});
document.addEventListener('click',()=>homeMenu.classList.remove('open'));

/* Search */
const searchInput=document.getElementById('search'); let t=null;
searchInput.addEventListener('input',()=>{clearTimeout(t); t=setTimeout(()=>{searchQuery=searchInput.value.trim().toLowerCase(); expanded=false; renderGrid();},150);});
renderGrid();

/* ===== DETAIL MODAL ===== */
const modal=document.getElementById('modal'); const dlgContent=document.getElementById('dlgContent'); const dlgBox=document.getElementById('dlgBox');
function closeModal(){
  dlgBox.classList.add('closing');
  modal.classList.add('closing');
  setTimeout(()=>{modal.classList.remove('show','closing'); dlgBox.classList.remove('closing'); modal.style.display='none';}, 240);
}
document.getElementById('dlgClose').onclick=closeModal;
function openDetail(r){
  dlgContent.innerHTML=`<img src="${imgOf(r.slug)}" alt="${r.name}" style="width:100%;height:240px;object-fit:cover;border-radius:12px"/>
  <div style="margin-top:12px"><div style="font:900 22px 'Baloo 2'">${r.name}</div><div style="color:#64748b;margin:6px 0">${r.addr}</div>
  <div><strong>Gi√°:</strong> ${r.price||'‚Äî'}</div><div><strong>Kho·∫£ng c√°ch:</strong> ${r.dist}</div><div style="margin-top:8px"><strong>ƒê√°nh gi√°:</strong> ‚òÖ ${r.rate}</div></div>`;
  modal.style.display='flex'; modal.classList.remove('closing');
  dlgBox.classList.remove('closing');
  requestAnimationFrame(()=>modal.classList.add('show'));
}
grid.addEventListener('click',e=>{const card=e.target.closest('.card'); if(!card)return; const id=+card.dataset.id; const r=DATA.find(x=>x.id===id); if(r) openDetail(r);});

/* ===== RANKING ===== */
const rankList=document.getElementById('rankList');
function renderRank(){rankList.innerHTML=''; [...DATA].sort((a,b)=>b.rate-a.rate).slice(0,5).forEach((r,i)=>{const cls=i===0?'no1':i===1?'no2':i===2?'no3':'noN';
  const div=document.createElement('div'); div.className='rank-item';
  div.innerHTML=`<div class="rank-no ${cls}">#${i+1}</div><div class="rank-title"><div style="font-weight:700">${r.name}</div><div style="color:#6b7280">${r.addr}</div></div><div class="trend">‚òÖ ${r.rate}</div>`;
  div.addEventListener('click',()=>openDetail(r)); rankList.appendChild(div);
});}
renderRank();

/* ===== AUTH MODAL ===== */
const auth=document.getElementById('auth'); const authCard=document.getElementById('authCard'); const btnOpenAuth=document.getElementById('btnOpenAuth');
const authClose=document.getElementById('authClose'); const loginCancel=document.getElementById('loginCancel'); const regCancel=document.getElementById('regCancel');
btnOpenAuth.onclick=()=>{auth.style.display='flex'; auth.classList.remove('closing'); authCard.classList.remove('closing'); requestAnimationFrame(()=>auth.classList.add('show'));};
function closeAuth(){
  authCard.classList.add('closing'); auth.classList.add('closing');
  setTimeout(()=>{auth.classList.remove('show','closing'); authCard.classList.remove('closing'); auth.style.display='none';}, 240);
}
[authClose,loginCancel,regCancel].forEach(b=>b.onclick=closeAuth);
const tabLogin=document.getElementById('tabLogin'); const tabRegister=document.getElementById('tabRegister');
const paneLogin=document.getElementById('paneLogin'); const paneRegister=document.getElementById('paneRegister');
tabLogin.onclick=()=>{tabLogin.classList.add('active'); tabRegister.classList.remove('active'); paneLogin.style.display='block'; paneRegister.style.display='none';}
tabRegister.onclick=()=>{tabRegister.classList.add('active'); tabLogin.classList.remove('active'); paneRegister.style.display='block'; paneLogin.style.display='none';}
document.getElementById('loginSubmit').onclick=()=>{const e=document.getElementById('loginEmail').value.trim(); const p=document.getElementById('loginPass').value.trim(); if(!e||!p) return alert('Vui l√≤ng nh·∫≠p Email & M·∫≠t kh·∫©u'); alert('ƒêƒÉng nh·∫≠p demo th√†nh c√¥ng!'); closeAuth();}
document.getElementById('regSubmit').onclick=()=>{const n=document.getElementById('regName').value.trim(); const e=document.getElementById('regEmail').value.trim(); const ph=document.getElementById('regPhone').value.trim(); const p=document.getElementById('regPass').value.trim(); if(!n||!e||!ph||!p) return alert('Vui l√≤ng ƒëi·ªÅn ƒë·ªß th√¥ng tin'); alert('ƒêƒÉng k√Ω demo th√†nh c√¥ng!'); closeAuth();}

/* ===== AI CHATBOT ===== */
const chatLog=document.getElementById('chatLog'); const chatInput=document.getElementById('chatInput'); const chatSend=document.getElementById('chatSend');
function pushMsg(who, text){const wrap=document.createElement('div'); wrap.style.margin='8px 0'; wrap.innerHTML=`<div style="font-weight:900;color:${who==='bot'?'#0b6b86':'#111'}">${who==='bot'?'AI':'B·∫°n'}</div><div>${text}</div>`; chatLog.appendChild(wrap); chatLog.scrollTop=chatLog.scrollHeight;}
pushMsg('bot','Ch√†o b·∫°n! B·∫°n mu·ªën ƒÉn g√¨ h√¥m nay? (g√µ: ph·ªü / c∆°m / b√∫n / ƒë·ªì u·ªëng / chay / r·∫ª / g·∫ßn ...)');
function suggest(prefCat){
  let list=DATA;
  if(prefCat){list=list.filter(x=>x.cat===prefCat);}
  list=[...list].sort((a,b)=>b.rate-a.rate).slice(0,3);
  if(list.length===0) return "M√¨nh ch∆∞a t√¨m th·∫•y qu√°n ph√π h·ª£p r·ªìi :(";
  return "B·∫°n th·ª≠ nh√©: " + list.map(x=>`<b>${x.name}</b> (${x.addr}, ‚òÖ${x.rate})`).join(" ¬∑ ");
}
function handleChat(msg){
  const m=msg.toLowerCase();
  const map = [
    [/ph·ªü|b√∫n|m√¨|mi·∫øn|h·ªß ti·∫øu|bun|pho/, 'bun'],
    [/c∆°m|com/, 'com'],
    [/tr√† s·ªØa|s·ªØa|tea|drink|n∆∞·ªõc|ƒë·ªì u·ªëng/, 'drink'],
    [/chay|rau|vegan/, 'other'],
    [/g√† r√°n|hamburger|pizza|khoai|fast/, 'fast'],
  ];
  for(const [re, cat] of map){ if(re.test(m)) return suggest(cat); }
  if(/r·∫ª|gi√° th·∫•p|ti·∫øt ki·ªám/.test(m)){
    const list=[...DATA].filter(x=>{
      const p=x.price.replace(/[^\d\-]/g,''); const num=+(p.split('-')[0]||'0');
      return num && num<=35;
    }).sort((a,b)=>b.rate-a.rate).slice(0,3);
    return list.length? "R·∫ª n√®: "+list.map(x=>`<b>${x.name}</b> (${x.price})`).join(" ¬∑ ") : "Ch∆∞a c√≥ danh s√°ch r·∫ª ph√π h·ª£p :(";
  }
  if(/g·∫ßn|distance|bao xa|ƒëi b·ªô/.test(m)){
    const list=[...DATA].sort((a,b)=>parseInt(a.dist)-parseInt(b.dist)).slice(0,3);
    return "G·∫ßn b·∫°n nh·∫•t: " + list.map(x=>`<b>${x.name}</b> (${x.dist})`).join(" ¬∑ ");
  }
  if(/ch√†o|hello|hi|xin ch√†o/.test(m)) return "Ch√†o b·∫°n! B·∫°n th√≠ch m√≥n g√¨: ph·ªü, c∆°m, b√∫n, ƒë·ªì u·ªëng, hay ƒë·ªì chay?";
  return "M√¨nh c√≥ th·ªÉ g·ª£i √Ω theo s·ªü th√≠ch. H√£y n√≥i: ‚Äúm√¨nh mu·ªën ƒÉn ph·ªü/c∆°m/ƒë·ªì u·ªëng‚Ä¶‚Äù ho·∫∑c ‚Äúr·∫ª‚Äù, ‚Äúg·∫ßn‚Äù.";
}
function sendChat(){const val=chatInput.value.trim(); if(!val) return; pushMsg('you', val); chatInput.value=''; setTimeout(()=>{pushMsg('bot', handleChat(val));}, 250);}
chatSend.onclick=sendChat; chatInput.addEventListener('keydown',e=>{if(e.key==='Enter') sendChat();});
</script>
</body>
</html>
